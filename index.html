<!DOCTYPE html>
<meta charset="utf-8">
<head>
<link href="style.css" rel="stylesheet" type="text/css">
</head>
<body>
<h2> World News Reader </h2>
<div id='container'></div> 
<script src="./js/d3.min.js"></script>
<script src="./js/topojson.v1.min.js"></script>
\
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script src="./js/JSPlacemaker.js"></script>
<script src="./modules/drawMap.js"></script> 
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="./modules/fetchNews.js"></script>
<script>
$('document').ready(function(){
	
	setTimeout(function(){
		for(var i =0; i<database.length; i++){
			if(database[i].coordinate)
			console.log(database[i].coordinate.latitude,database[i].coordinate.longitude);
		}
		var data = d3.entries(database);

	  // circle.exit().remove();
		
		g.selectAll("circle")
	    .data(data)
	    .enter()
	    .append("circle")
	    .attr("r", 8)
	    .attr("cx", function(d) { 
	    	if(d.value.coordinate){
	    		var x = parseFloat(d.value.coordinate.latitude);
	    		var y = parseFloat(d.value.coordinate.longitude);
	    	  console.log("Projection Long val ", projection([y,x])[0]);
	    	  return projection([y,x])[0];
	    	}
	    	else
	    	  return 100; 
	    })
	    .attr("cy", function(d) { 
	    	if(d.value.coordinate){
	    		var x = parseFloat(d.value.coordinate.latitude);
	    		var y = parseFloat(d.value.coordinate.longitude);
	    	  console.log("Projection Lat val ", projection([y,x])[1]);

	    	  return projection([y,x])[1];
	    	}
	    	else
	    	  return 100; 
	    })
	    .style("fill", "black");

	},5000);

	 d3.csv("data/cities.csv", function(error, data) {
        g.selectAll("circle")
           .data(data)
           .enter()
           .append("circle")
           .attr("cx", function(d) {
           				// console.log(projection([d.lon, d.lat]));
           				// console.log(projection([d.lon, d.lat])[0]);
                   return projection([d.lon, d.lat])[0];
           })
           .attr("cy", function(d) {
                   return projection([d.lon, d.lat])[1];
           })
           .attr("r", 4)
           .style("fill", "maroon");
      });

});
</script>

</body>
</html>
